
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIDAS ERP Отчет</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #4FC3F7; /* Light Blue */
            --secondary-color: #29B6F6; /* Slightly Darker Light Blue */
            --accent-color: #FFCA28; /* Amber/Yellow */
            --text-color: #E0E0E0; /* Light Gray for text */
            --background-color: #1E2732; /* Dark Slate Blue/Gray */
            --card-background-color: #2C3A47; /* Slightly lighter dark blue/gray for cards */
            --heading-color: #FFFFFF; /* White for main headings */
            --border-color: #3E5060;
            --subtle-text-color: #B0BEC5; /* Lighter gray for less prominent text */
            --icon-color: var(--accent-color);

            /* Custom status colors */
            --status-success: #81C784; /* Green */
            --status-failure: #E57373; /* Red */
            --status-skipped: #90A4AE; /* Gray */
            --status-warning: #FFCA28; /* Amber/Yellow */
        }

        /* Стили для карточек в "Выполненные модули" */
        .modules-stats-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: space-between;
        }

        .module-stat-card {
            background: var(--card-background-color);
            border-radius: 10px;
            padding: 15px;
            flex: 1;
            min-width: 120px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            border-top: 3px solid var(--primary-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .module-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .module-stat-card.success {
            border-top-color: var(--status-success);
        }

        .module-stat-card.failure {
            border-top-color: var(--status-failure);
        }

        .module-stat-card.skipped {
            border-top-color: var(--status-skipped);
        }

        .module-stat-card.time {
            border-top-color: var(--accent-color);
        }

        .stat-icon {
            font-size: 22px;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .module-stat-card.success .stat-icon {
            color: var(--status-success);
        }

        .module-stat-card.failure .stat-icon {
            color: var(--status-failure);
        }

        .module-stat-card.skipped .stat-icon {
            color: var(--status-skipped);
        }

        .module-stat-card.time .stat-icon {
            color: var(--accent-color);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--heading-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--subtle-text-color);
            font-weight: 500;
        }

        .module-cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .module-card {
            background: var(--card-background-color);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-left: 4px solid var(--primary-color);
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .module-card.status-success {
            border-left-color: var(--status-success);
        }

        .module-card.status-failure {
            border-left-color: var(--status-failure);
        }

        .module-card.status-skipped {
            border-left-color: var(--status-skipped);
        }

        .module-card-header {
            padding: 15px;
            background: rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .module-card-icon {
            font-size: 18px;
            color: var(--accent-color);
            margin-right: 12px;
            width: 20px;
            height: 20px;
        }
        
        img.module-card-icon {
            filter: brightness(1.2) contrast(0.9) sepia(0.3) hue-rotate(-10deg) saturate(1.5); /* Create yellow tint effect */
            border-radius: 3px;
        }

        .module-card-title {
            flex: 1;
            font-weight: 500;
            color: var(--heading-color);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .module-card-body {
            padding: 15px;
            flex: 1;
        }

        .module-card-metrics {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .module-card-metric {
            background: rgba(0,0,0,0.15);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 13px;
            color: var(--text-color);
            display: inline-flex;
            align-items: center;
        }

        .metric-icon {
            margin-right: 6px;
            color: var(--primary-color);
            font-size: 12px;
        }

        .module-card-footer {
            padding: 10px 15px;
            border-top: 1px solid var(--border-color);
            text-align: center;
        }

        .module-card-link {
            color: var(--accent-color);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            display: block;
            transition: color 0.2s ease;
        }

        .module-card-link:hover {
            color: var(--primary-color);
        }

        .module-card-link i {
            margin-right: 5px;
        }

        .status-icon {
            margin-right: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background: var(--background-color);
            color: var(--text-color);
            line-height: 1.7;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: var(--card-background-color);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
        }

        .main-title {
            text-align: center;
            margin: 10px 0 20px;
            color: var(--heading-color);
            font-family: 'Roboto', sans-serif;
            font-size: 32px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .tabs {
            display: flex;
            gap: 10px; /* Adjusted gap */
            margin-bottom: 20px; /* Adjusted margin */
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 1px solid var(--border-color); /* Added border */
            padding-bottom: 10px; /* Added padding */
        }

        .tab {
            padding: 8px 15px; /* Adjusted padding */
            background: var(--background-color); /* Darker background for tabs */
            color: var(--subtle-text-color); /* Lighter text for inactive tabs */
            border: none;
            border-radius: 5px; /* Smaller radius */
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px; /* Smaller font */
            font-weight: 500; /* Lighter weight */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab i {
            margin-right: 5px; /* Adjusted margin */
        }

        .tab-img-icon { /* Style for image-based icons in tabs */
            width: 1.1em; /* Adjust size as needed */
            height: 1.1em; /* Adjust size as needed */
            margin-right: 5px;
            vertical-align: text-bottom; /* Align with text better */
            filter: grayscale(100%) brightness(1.5); /* Make it monochrome but brighter */
            opacity: 0.8; /* Adjust for blending, if needed */
            transition: filter 0.3s ease, opacity 0.3s ease;
        }
        
        .tab:hover .tab-img-icon {
            filter: sepia(0.5) hue-rotate(-15deg) saturate(5) brightness(1.2); /* Yellow tint on hover */
            opacity: 1;
        }
        
        .tab.active .tab-img-icon {
            filter: sepia(0.8) hue-rotate(-20deg) saturate(8) brightness(1.2); /* Stronger yellow tint when active */
            opacity: 1;
        }

        .tab:hover {
            background: var(--secondary-color); /* Hover color */
            color: var(--heading-color); /* Text color on hover */
             transform: translateY(-2px); /* Slight lift */
        }

        .tab.active {
            background: var(--primary-color); /* Active color */
            color: var(--heading-color); /* Text color on active */
            box-shadow: 0 3px 6px rgba(79, 195, 247, 0.3);
        }

        .report-content {
            background: var(--background-color); /* Content background */
            padding: 25px; /* Adjusted padding */
            border-radius: 8px; /* Smaller radius */
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: none; /* Hide by default */
            opacity: 0; /* For fade-in animation */
            transform: translateY(10px); /* For slide-in animation */
            transition: opacity 0.5s ease, transform 0.5s ease; /* Animation */
        }

        .report-content.active {
            display: block; /* Show active content */
            opacity: 1;
            transform: translateY(0);
        }

        .section {
            margin-bottom: 25px; /* Adjusted margin */
            padding: 0; /* Remove inner padding */
            background: none; /* Remove background */
            box-shadow: none; /* Remove shadow */
        }

        .section h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 26px;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 8px;
            display: inline-block;
        }
        .section h2 i {
            margin-right: 8px;
            color: var(--accent-color);
        }

        .section h3 {
            color: var(--secondary-color);
            margin: 20px 0 10px;
            font-size: 20px;
            font-family: 'Roboto', sans-serif;
        }
        .section h3 i {
            margin-right: 6px;
            font-size: 0.9em;
        }

        ul, ol {
            list-style-type: none;
            padding-left: 0;
        }

        li {
            margin-bottom: 12px; /* Increased margin for clarity */
            color: var(--subtle-text-color);
            position: relative;
            padding-left: 20px;
            border-bottom: 1px dashed var(--border-color); /* Add a subtle separator */
            padding-bottom: 10px; /* Padding below separator */
        }
         li:last-child {
             border-bottom: none;
         }

        li i.list-icon {
            position: absolute;
            left: 0;
            top: 3px;
            color: var(--accent-color);
            font-size: 0.8em;
        }

        li strong {
            color: var(--text-color);
        }

        p {
            margin-bottom: 10px;
            color: var(--subtle-text-color);
        }
        p strong {
            color: var(--text-color);
        }

        .module-status {
            font-weight: bold;
        }

        .status-success {
            color: var(--status-success);
        }

        .status-failure {
            color: var(--status-failure);
        }

        .status-skipped {
            color: var(--status-skipped);
        }

        .log-output {
            background: #1A232E;
            color: #B0BEC5;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            border: 1px solid var(--border-color);
            max-height: 300px; /* Increased max height for log */
            overflow-y: auto;
             line-height: 1.5; /* Adjust line height for readability */
        }

         .chart-container {
            position: relative;
            margin: 20px auto; /* Center the container */
            padding: 15px;
            background: var(--card-background-color); /* Use darker background for inner card */
            border-radius: 8px;
            height: 300px;
            width: 95%;
            box-shadow: inset 0 0 8px rgba(0,0,0,0.3); /* Inner shadow for depth */
            color: var(--text-color);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Placeholder text styling */
            font-size: 1.2em;
            color: var(--subtle-text-color);
         }
         .chart-container::before {
            content: "Место для графика/статистики"; /* Display placeholder text in Russian */
         }

         .pie-chart-container {
            display: flex;
            align-items: center;
            justify-content: space-around; /* or center */
            flex-wrap: wrap; /* Allow legend to wrap on small screens */
            margin-top: 20px;
            padding: 15px;
            background: var(--card-background-color);
            border-radius: 8px;
            box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
            min-height: 180px; /* Ensure container has some height */
        }

        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 10px;
        }

        .pie-chart-legend {
            margin-left: 20px;
            font-size: 0.9em;
        }

        .pie-chart-legend p {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .pie-chart-legend .legend-color {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 3px;
            margin-right: 8px;
            border: 1px solid var(--border-color);
        }

         /* Layout and Navigation - Using tabs */
         /* .report-content {  -- This rule is now more comprehensively defined above
             display: none;
         } */

         #summary-content {
             /* This is handled by .report-content.active on the summary div now, so this ID-specific rule can be less specific or removed if summary has .active by default */
             /* display: block; Show summary content by default */
         }

         .detail-arrow {
             color: var(--accent-color); /* Use accent color for links */
             text-decoration: none;
             margin-left: 10px; /* Add some space after module name */
             font-size: 1.1em; /* Larger arrow */
             transition: color 0.3s ease, transform 0.3s ease;
             display: inline-block; /* Allow transform */
         }

         .detail-arrow:hover {
             color: var(--primary-color); /* Change color on hover */
              transform: translateX(3px); /* Slight slide on hover */
         }

         /* Toggle Log Button */
         .toggle-log-btn {
             background: var(--secondary-color);
             color: var(--heading-color);
             border: none;
             padding: 10px 15px;
             border-radius: 5px;
             cursor: pointer;
             margin-top: 15px;
             margin-bottom: 15px;
             font-size: 1em;
             transition: background-color 0.3s ease;
             display: flex;
             align-items: center;
         }

         .toggle-log-btn:hover {
             background: var(--primary-color);
         }

         .toggle-log-btn i {
             margin-right: 8px;
             transition: transform 0.3s ease;
         }

         .log-container {
             margin-top: 0;
         }

        .bar-chart-container {
            margin-top: 15px;
            padding: 15px;
            background: var(--card-background-color);
            border-radius: 8px;
            box-shadow: inset 0 0 8px rgba(0,0,0,0.2);
        }
        .bar-chart-container h4 { /* Style for the heading */
            margin-top: 0; /* Remove default top margin */
            margin-bottom: 12px; /* Space between title and chart items */
            font-size: 1.1em; /* Match .vendor-summary h4 */
            color: var(--primary-color); /* Match .vendor-summary h4 */
        }
        .bar-chart-container h4 i { /* Style for the icon within the heading */
            margin-right: 8px; /* Match .vendor-summary h4 i */
            color: var(--accent-color); /* Match .vendor-summary h4 i */
        }
        .bar-chart-item {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        .bar-label {
            flex-basis: 290px; /* Adjusted for potentially longer labels */
            font-size: 0.85em;
            color: var(--subtle-text-color);
            margin-right: 10px;
            flex-shrink: 0;
        }
        .bar-wrapper {
            flex-grow: 1;
            background-color: var(--background-color);
            border-radius: 4px;
            height: 22px;
            min-width: 100px;
            display: flex;
            align-items: center;
            border: 1px solid var(--border-color);
        }
        .bar {
            height: 100%;
            border-radius: 3px; /* Slightly smaller radius to fit inside wrapper */
            transition: width 0.5s ease-in-out;
            text-align: right;
            /* padding-right: 5px; Text now outside bar */
            color: var(--heading-color);
            font-size: 0.8em;
            line-height: 22px;
            overflow: hidden;
            white-space: nowrap;
            box-shadow: inset 0 -2px 2px rgba(0,0,0,0.15);
        }
        .bar-percentage {
            width: 45px; /* Fixed width for consistent layout */
            margin-left: 5px;
            font-size: 0.8em;
            color: var(--subtle-text-color);
            flex-shrink: 0; /* Prevent shrinking */
            text-align: left; /* Align text within its fixed width box */
        }
        .vendor-summary {
            padding: 20px 15px; /* Increased padding for better spacing */
            margin-bottom: 15px;
            background: var(--card-background-color);
            border-radius: 6px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
        }
        .vendor-summary h4 {
            margin-top: 0; /* Remove default browser top margin */
            margin-bottom: 12px; /* Space between title and list */
            font-size: 1.1em;
            color: var(--primary-color); /* Match other subheadings */
        }
        .vendor-summary h4 i {
            margin-right: 8px;
            color: var(--accent-color);
        }
        .vendor-summary ul {
            list-style-type: disc;
            padding-left: 25px; /* Indent list items */
            margin-bottom: 0; /* Remove default browser bottom margin */
        }
        .vendor-summary ul li {
            padding-left: 0; /* Reset padding from general li style */
            border-bottom: none; /* Remove separator from general li style */
            margin-bottom: 8px; /* Space between list items */
        }

        .vendor-data-output { /* New style for vendor data pre */
            background: #1A232E;
            color: #B0BEC5;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            border: 1px solid var(--border-color);
            max-height: 450px; /* Larger max height */
            overflow-y: auto;
            line-height: 1.5;
        }

        .vendor-data-container { /* Container for vendor data pre and copy button */
            position: relative; /* For absolute positioning of copy button */
        }

        .copy-btn { /* General style for copy buttons */
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: transparent; /* Changed for transparent background */
            color: var(--primary-color);    /* Changed for light blue icon/text */
            border: none; /* Ensuring no border unless specified */
            border-radius: 4px;
            padding: 5px 8px;
            cursor: pointer;
            font-size: 0.9em;
            z-index: 10; /* Ensure it is above the pre block */
            transition: color 0.2s ease, background-color 0.2s ease; /* Adjusted transition */
        }
        .copy-btn:hover {
            background-color: rgba(79, 195, 247, 0.15); /* Subtle light blue tint on hover */
            color: var(--secondary-color); /* Darker icon/text on hover */
        }
        .copy-btn i {
            margin-right: 3px;
        }

         .toggle-vendor-data-btn { /* New style for vendor data toggle */
            background: var(--secondary-color);
            color: var(--heading-color);
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px; /* Matches log button */
            margin-bottom: 15px; /* Matches log button */
            font-size: 1em;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
        }
        .toggle-vendor-data-btn:hover {
            background: var(--primary-color);
        }
        .toggle-vendor-data-btn i {
            margin-right: 8px;
            transition: transform 0.3s ease;
        }

        /* Generic classes for data display */
        .content-data-container { 
            position: relative; /* For absolute positioning of copy button */
        }

        .content-pre-output { 
            background: #1A232E;
            color: #B0BEC5;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            border: 1px solid var(--border-color);
            max-height: 450px; /* Default max height, can be overridden if needed */
            overflow-y: auto;
            line-height: 1.5;
        }

        .vendor-data-container { /* REMOVE if .content-data-container is sufficient */
            /* position: relative; */ /* Already in .content-data-container */
        }

        .vendor-data-output { /* REMOVE if .content-pre-output is sufficient */
            /* background: #1A232E; ... styles are same as .content-pre-output ... */
            /* max-height: 450px; */
        }
         .log-output { /* REMOVE if .content-pre-output is sufficient */
             /* background: #1A232E; ... styles are same as .content-pre-output ... */
             /* max-height: 300px; */ /* Might need to adjust if specific log height is desired */
        }
        .log-container { /* REMOVE if .content-data-container is sufficient */
            /* margin-top: 0; */ /* Covered by .content-pre-output margin */
        }

        /* Generic toggle button for collapsible content */
        .toggle-content-btn {
            background: var(--secondary-color);
            color: var(--heading-color);
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px; 
            margin-bottom: 10px; /* Adjusted bottom margin slightly */
            font-size: 1em;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
        }
        .toggle-content-btn:hover {
            background: var(--primary-color);
        }
        .toggle-content-btn i {
            margin-right: 8px;
            transition: transform 0.3s ease;
        }

        .download-btn { /* Style for download buttons */
            position: absolute;
            top: 5px;
            right: 40px; /* Position next to copy button */
            background-color: transparent;
            color: var(--primary-color);
            border: none;
            border-radius: 4px;
            padding: 5px 8px;
            cursor: pointer;
            font-size: 0.9em;
            z-index: 10;
            transition: color 0.2s ease, background-color 0.2s ease;
        }
        .download-btn:hover {
            background-color: rgba(79, 195, 247, 0.15);
            color: var(--secondary-color);
        }
        .download-btn i {
            margin-right: 3px;
        }

        .report-credit { /* Style for the new credit text */
            /* position: absolute; Removed for positioning inside container */
            /* top: 10px; Removed */
            /* left: 10px; Removed */
            font-size: 0.75em; /* Small text */
            color: var(--subtle-text-color); /* Gray color */
            font-style: italic; /* Italicized */
            /* z-index: 100; Likely not needed anymore */
            text-align: left; /* Ensure it aligns left */
            margin-bottom: 10px; /* Add some space below it */
            padding-left: 5px; /* Minor padding if needed */
        }

        .info-block { /* Style for info blocks in additional info tab */
            margin-bottom: 20px;
            padding: 10px;
            background-color: var(--background-color); /* Slightly lighter than card-bg */
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }
        .info-block h3 {
            font-size: 1.1em;
            color: var(--primary-color);
            margin-bottom: 8px;
            margin-top: 0; /* Reset top margin for h3 inside info-block */
        }

        .important-card { /* Style for the yellow "Важно" card */
            background-color: var(--accent-color); /* Changed to accent-color (icon-color) */
            color: var(--card-background-color); /* Changed to card-background-color for text */
            border: 1px solid var(--accent-color); /* Adjusted border */
            border-left: 5px solid var(--background-color); /* Darker accent for left border */
            padding: 15px;
            margin-top: 20px;
            margin-bottom: 25px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .important-card h4 {
            color: var(--card-background-color); /* Changed for heading text */
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.15em;
        }
        .important-card h4 i {
            margin-right: 8px;
            color: var(--card-background-color); /* Changed for icon color */
        }
        .important-card ul {
            list-style-type: disc;
            padding-left: 25px; /* Indent list items */
            margin-bottom: 0;
        }
        .important-card ul li {
            margin-bottom: 8px;
            padding-left: 0; /* Reset padding */
            border-bottom: none; /* Reset border */
            color: var(--card-background-color); /* Ensure list item text color matches */
        }

        /* Style for links in the additional info tab */
        #additional-info-content a {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        #additional-info-content a:hover {
            color: var(--primary-color); /* Or a slightly lighter/darker accent */
            text-decoration: underline;
        }

        .tab-navigation-arrows {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }
        .nav-arrow-btn {
            background-color: transparent; /* No background fill */
            color: var(--primary-color); /* Blue text and icon */
            border: 1px solid var(--primary-color); /* Blue border for definition */
            padding: 4px 8px; /* Even smaller padding */
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em; /* Even smaller font */
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease; /* Added transitions */
            display: inline-flex; /* To align icon and text */
            align-items: center;
        }
        .nav-arrow-btn:hover {
            background-color: rgba(79, 195, 247, 0.1); /* Very light blue tint on hover */
            color: var(--secondary-color); /* Slightly darker blue text on hover */
            border-color: var(--secondary-color); /* Darker border on hover */
        }
        .nav-arrow-btn:disabled {
            background-color: transparent;
            color: var(--subtle-text-color);
            border-color: var(--subtle-text-color); /* Gray border when disabled */
            cursor: not-allowed;
        }
        .nav-arrow-btn i {
            margin-right: 8px; /* Space between icon and text (for next) */
        }
        .nav-arrow-btn.prev i {
            margin-right: 0; /* No space for prev icon */
            margin-left: 8px; /* Space after icon for prev */
        }
        .nav-arrow-btn.prev {
            order: 1; /* Prev button on the left */
        }
        .nav-arrow-btn.next {
            order: 2; /* Next button on the right */
        }
        .nav-arrow-btn.prev i { /* Swap icon and text order for prev button */
            order: -1;
            margin-right: 8px; 
            margin-left:0;
        }

         /* Add styles for the OFD links table */
         .ofd-links-table-container {
             max-height: 500px; /* Limit height and enable scrolling */
             overflow-y: auto;
             margin-top: 15px;
             border: 1px solid var(--border-color);
             border-radius: 8px;
         }

        .ofd-links-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            table-layout: auto; /* Allow columns to size based on content */
        }

        .ofd-links-table th,
        .ofd-links-table td {
            border: 1px solid var(--border-color);
            padding: 10px 8px; /* Adjust padding */
            text-align: left;
            word-break: break-word; /* Break long words */
        }

        .ofd-links-table th {
            background-color: var(--card-background-color); /* Darker header background */
            color: var(--heading-color);
            font-weight: 500;
            position: sticky; /* Make header sticky */
            top: 0;
            z-index: 5;
        }

        .ofd-links-table tbody tr:nth-child(even) {
            background-color: var(--background-color); /* Alternate row color */
        }

        .ofd-links-table tbody tr:hover {
            background-color: rgba(79, 195, 247, 0.08); /* Subtle hover effect */
        }

        .ofd-links-table a {
             color: var(--accent-color); /* Link color */
             text-decoration: none;
             word-break: break-all; /* Break long URLs */
        }

        .ofd-links-table a:hover {
             text-decoration: underline;
        }

        .transaction-number-column {
            min-width: 180px; /* Set a minimum width for the transaction number column */
        }

        /* Styles for the filter input and button */
        .filter-container {
            display: flex;
            align-items: center;
            margin-left: 20px; /* Space from the heading */
        }

        .filter-input {
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--background-color);
            color: var(--text-color);
            font-size: 0.9em;
            margin-right: 5px;
            outline: none; /* Remove default outline */
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .filter-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 5px rgba(79, 195, 247, 0.5); /* Blue glow effect */
        }

        .filter-button {
            padding: 6px 10px;
            background-color: var(--secondary-color); /* Blue button */
            color: var(--heading-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .filter-button:hover {
            background-color: var(--primary-color); /* Lighter blue on hover */
        }

        .filter-button i {
            margin-right: 0; /* No margin for standalone icon */
        }

        /* Add styles for the cash data table */
        .cash-data-table-container, .comparison-table-container, .midas-pos-table-container {
            max-height: 500px; /* Limit height and enable scrolling */
            overflow-y: auto;
            margin-top: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }

        .cash-data-table, .comparison-table, .midas-pos-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            table-layout: auto; /* Allow columns to size based on content */
        }

        .cash-data-table th, .cash-data-table td,
        .comparison-table th, .comparison-table td,
        .midas-pos-table th, .midas-pos-table td {
            border: 1px solid var(--border-color);
            padding: 10px 8px; /* Adjust padding */
            text-align: left;
            word-break: break-word; /* Break long words */
        }

        .cash-data-table th, .comparison-table th, .midas-pos-table th {
            background-color: var(--card-background-color); /* Darker header background */
            color: var(--heading-color);
            font-weight: 500;
            position: sticky; /* Make header sticky */
            top: 0;
            z-index: 5;
        }

        .cash-data-table tbody tr:nth-child(even),
        .comparison-table tbody tr:nth-child(even),
        .midas-pos-table tbody tr:nth-child(even) {
            background-color: var(--background-color); /* Alternate row color */
        }

        .cash-data-table tbody tr:hover,
        .comparison-table tbody tr:hover,
        .midas-pos-table tbody tr:hover {
            background-color: rgba(79, 195, 247, 0.08); /* Subtle hover effect */
        }
        
        .order-number-column {
            min-width: 120px; /* Set a minimum width for the order number column */
        }
        
        .position-data-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .position-data-item {
            background-color: var(--background-color);
            padding: 8px;
            margin-bottom: 8px;
            border-radius: 4px;
            border-left: 3px solid var(--accent-color);
        }
        
        .item-with-issues {
            border-left: 3px solid var(--status-failure);
        }
        
        .issue-text {
            color: var(--status-failure);
            font-weight: 500;
        }
        
        .ok-text {
            color: var(--status-success);
        }
        
        .position-data-item:last-child {
            margin-bottom: 0;
        }
        
        /* JSON data display styles */
        .json-data-container {
            position: relative;
            max-height: 150px;
            overflow-y: auto;
            background-color: var(--background-color);
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }
        
        .json-data {
            margin: 0;
            padding: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            white-space: pre-wrap;
            color: var(--text-color);
        }
        
        .json-copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--card-background-color);
            color: var(--primary-color);
            border: none;
            border-radius: 4px;
            padding: 3px 6px;
            font-size: 0.8em;
            cursor: pointer;
            z-index: 10;
            opacity: 0.7;
            transition: opacity 0.2s, background-color 0.2s;
        }
        
        .json-copy-btn:hover {
            opacity: 1;
            background-color: var(--background-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="report-credit">Отчет создан командой OD</div>
        <h1 class="main-title"><i class="fas fa-chart-bar"></i> Отчет об ошибках между MIDAS и ERP</h1>

        <div class="tabs">
            <button class="tab active" data-target="summary-content"><i class="fas fa-info-circle"></i> Сводка</button>
            <button class="tab" data-target="google-sheets-content"><i class="fab fa-google-drive"></i> Экспорт данных в Google Sheets</button><button class="tab" data-target="module-1-content"><i class="fas fa-receipt"></i> Анализ чеков</button><button class="tab" data-target="module-2-content"><i class="fas fa-link"></i> Получение ссылок на чеки ОФД</button><button class="tab" data-target="sap-content"><img src="https://img.icons8.com/color/48/sap.png" class="tab-img-icon" alt="Данные позиций заказа из SAP icon"> Данные позиций заказа из SAP</button><button class="tab" data-target="midas-content"><i class="fas fa-cogs"></i> Данные позиций заказа из MIDAS</button><button class="tab" data-target="midas-erp-content"><i class="fas fa-exchange-alt"></i> Сравнение позиций заказа MIDAS и ERP</button><button class="tab" data-target="module-6-content"><i class="fas fa-balance-scale-left"></i> Анализ расхождений по вендорам</button>
            <button class="tab" data-target="additional-info-content"><i class="fas fa-book-reader"></i> Дополнительная информация</button>
        </div>

        <div id="summary-content" class="report-content active">
            <div class="section">
                 
            <h2><i class="fas fa-info-circle"></i> Общая сводка отчета</h2>
            <p><strong><i class="far fa-clock list-icon"></i> Время начала:</strong> 5/19/2025, 4:23:56 AM</p>
            <p><strong><i class="far fa-clock list-icon"></i> Время окончания:</strong> 5/19/2025, 4:24:58 AM</p>
            <p><strong><i class="fas fa-hourglass-half list-icon"></i> Общая продолжительность:</strong> 62.28 секунд</p>
            <p><strong><i class="fas fa-file-alt list-icon"></i> Используемый лист:</strong> report_1</p>
            <p><strong><i class="fas fa-check-circle list-icon"></i> Статус отчета:</strong> <span class="module-status status-success">ЗАВЕРШЕН</span></p>
            <p><strong><i class="fas fa-external-link-alt list-icon"></i> Ссылка на Google Sheet:</strong> <a href="https://docs.google.com/spreadsheets/d/1e0oIhEYcZCAQGwD2pLniTlQ1Ojqe-bQJrA4oTRQzc44/edit" target="_blank" style="color: var(--accent-color); text-decoration: none;">https://docs.google.com/spreadsheets/d/1e0oIhEYcZCAQGwD2pLniTlQ1Ojqe-bQJrA4oTRQzc44/edit</a></p>
        
            </div>

            <div class="section">
                <h2><i class="fas fa-clipboard-list"></i> Выполненные модули</h2>
                
                <div class="modules-stats-container">
                    <div class="module-stat-card time">
                        <i class="fas fa-clock stat-icon"></i>
                        <div class="stat-value">62.3 сек</div>
                        <div class="stat-label">Общее время</div>
                    </div>
                    <div class="module-stat-card">
                        <i class="fas fa-cubes stat-icon"></i>
                        <div class="stat-value">7</div>
                        <div class="stat-label">Всего модулей</div>
                    </div>
                    <div class="module-stat-card success">
                        <i class="fas fa-check-circle stat-icon"></i>
                        <div class="stat-value">4</div>
                        <div class="stat-label">Успешно</div>
                    </div>
                    <div class="module-stat-card failure">
                        <i class="fas fa-times-circle stat-icon"></i>
                        <div class="stat-value">1</div>
                        <div class="stat-label">С ошибками</div>
                    </div>
                    <div class="module-stat-card skipped">
                        <i class="fas fa-ban stat-icon"></i>
                        <div class="stat-value">1</div>
                        <div class="stat-label">Пропущено</div>
                    </div>
                </div>
                
                <div class="module-cards-container">
                
                        <div class="module-card status-success">
                            <div class="module-card-header">
                                <i class="fab fa-google-drive module-card-icon"></i>
                                <div class="module-card-title">Экспорт данных в Google Sheets</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-check-circle status-icon"></i> УСПЕШНО
                                </div>
                                <div class="module-card-metrics">
                                    
                            <div class="module-card-metric">
                                <i class="fas fa-file-export metric-icon"></i> Строк: 10
                            </div>
                        
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#google-sheets-content" class="module-card-link" data-target="google-sheets-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                        <div class="module-card status-success">
                            <div class="module-card-header">
                                <i class="fas fa-receipt module-card-icon"></i>
                                <div class="module-card-title">Анализ чеков</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-check-circle status-icon"></i> УСПЕШНО
                                </div>
                                <div class="module-card-metrics">
                                    
                            <div class="module-card-metric">
                                <i class="fas fa-chart-pie metric-icon"></i> ZIMG: 10
                                  </div>
                
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#module-1-content" class="module-card-link" data-target="module-1-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                        <div class="module-card status-skipped">
                            <div class="module-card-header">
                                <i class="fas fa-link module-card-icon"></i>
                                <div class="module-card-title">Получение ссылок на чеки ОФД</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-ban status-icon"></i> ПРОПУЩЕН
                                </div>
                                <div class="module-card-metrics">
                                    
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#module-2-content" class="module-card-link" data-target="module-2-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                        <div class="module-card status-success">
                            <div class="module-card-header">
                                <img src="https://img.icons8.com/color/48/sap.png" class="module-card-icon" alt="Данные позиций заказа из SAP icon">
                                <div class="module-card-title">Данные позиций заказа из SAP</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-check-circle status-icon"></i> УСПЕШНО
                                </div>
                                <div class="module-card-metrics">
                                    
                            <div class="module-card-metric">
                                <i class="far fa-clock metric-icon"></i> Время: 18.83 сек
                            </div>
                        
                            <div class="module-card-metric">
                                <i class="fas fa-clipboard-check metric-icon"></i> Заказов: 10
                            </div>
                        
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#sap-content" class="module-card-link" data-target="sap-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                        <div class="module-card status-failure">
                            <div class="module-card-header">
                                <i class="fas fa-cogs module-card-icon"></i>
                                <div class="module-card-title">Данные позиций заказа из MIDAS</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-times-circle status-icon"></i> ОШИБКА
                                </div>
                                <div class="module-card-metrics">
                                    
                            <div class="module-card-metric">
                                <i class="far fa-clock metric-icon"></i> Время: 18.42 сек
                            </div>
                        
                            <div class="module-card-metric">
                                <i class="fas fa-clipboard-check metric-icon"></i> Заказов: 10
                            </div>
                        
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#midas-content" class="module-card-link" data-target="midas-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                        <div class="module-card status-success">
                            <div class="module-card-header">
                                <i class="fas fa-exchange-alt module-card-icon"></i>
                                <div class="module-card-title">Сравнение позиций заказа MIDAS и ERP</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-check-circle status-icon"></i> УСПЕШНО
                                </div>
                                <div class="module-card-metrics">
                                    
                            <div class="module-card-metric">
                                <i class="far fa-clock metric-icon"></i> Время: 15.75 сек
                            </div>
                        
                            <div class="module-card-metric">
                                <i class="fas fa-clipboard-check metric-icon"></i> Заказов: 10
                            </div>
                        
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#midas-erp-content" class="module-card-link" data-target="midas-erp-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                        <div class="module-card status-running">
                            <div class="module-card-header">
                                <i class="fas fa-balance-scale-left module-card-icon"></i>
                                <div class="module-card-title">Анализ расхождений по вендорам</div>
                            </div>
                            <div class="module-card-body">
                                <div class="module-card-status">
                                    <i class="fas fa-ban status-icon"></i> ПРОПУЩЕН
                                </div>
                                <div class="module-card-metrics">
                                    
                                </div>
                            </div>
                            <div class="module-card-footer">
                                <a href="#module-6-content" class="module-card-link" data-target="module-6-content">
                                    <i class="fas fa-arrow-circle-right"></i> Подробнее
                                </a>
                            </div>
                        </div>
                    
                </div>
            </div>
            <div class="tab-navigation-arrows">
                <button class="nav-arrow-btn prev" data-direction="prev" style="display: none;"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
            </div>
        </div>

        
                 <div id="google-sheets-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Экспорт данных в Google Sheets - <span class="module-status status-success">УСПЕШНО</span></h2>
                         
                   <div class="module-summary">
                       <h3><i class="fas fa-poll"></i> Итоги модуля:</h3>
                       
                          <p><strong><i class="fas fa-file-export list-icon"></i> Экспортировано строк:</strong> 10 в лист 'report_1_2'</p>
                      
                   </div>
                   <div class="module-detailed-info">
                       <h3 style="display: flex; align-items: center; justify-content: space-between;">
                           <span><i class="fas fa-chart-bar"></i> Детальная информация и аналитика:</span>
                           
                       </h3>
                       
                        <div style="padding: 10px;">
                            <p><strong><i class="fas fa-link list-icon"></i> Ссылка на Google Sheet:</strong> <a href="https://docs.google.com/spreadsheets/d/1e0oIhEYcZCAQGwD2pLniTlQ1Ojqe-bQJrA4oTRQzc44/edit" target="_blank" style="color: var(--accent-color); text-decoration: none;">https://docs.google.com/spreadsheets/d/1e0oIhEYcZCAQGwD2pLniTlQ1Ojqe-bQJrA4oTRQzc44/edit</a></p>
                            <p style="margin-top: 10px;"><small><i class="far fa-clock list-icon"></i> Время выполнения для этого модуля отдельно не отслеживается в логах.</small></p>
                        </div>
                      
                   </div>
                 
                         
                         
                         
                         
                    <div class="module-log-section">
                        <h3><i class="far fa-file-alt"></i> Лог выполнения:</h3>
                        <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать Лог</button>
                        <div class="content-data-container" style="display: none;"><pre class="content-pre-output">INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/run_export.js] {"level":"info","message":"Using input file: /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/Input/Error_prepaid_data_202505180127.csv","timestamp":"2025-05-19T01:23:56.774Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/run_export.js] {"level":"info","message":"Creating new sheet: report_1_2","timestamp":"2025-05-19T01:23:57.471Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/run_export.js] {"level":"info","message":"Data successfully exported to sheet 'report_1_2' (10 rows)","timestamp":"2025-05-19T01:24:01.401Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/run_export.js] {"level":"info","message":"Экспорт успешно завершен. Данные экспортированы в лист 'report_1_2'","timestamp":"2025-05-19T01:24:01.402Z"}</pre></div>
                    </div>
                
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             
                 <div id="module-1-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Анализ чеков - <span class="module-status status-success">УСПЕШНО</span></h2>
                         
                   <div class="module-summary">
                       <h3><i class="fas fa-poll"></i> Итоги модуля:</h3>
                       
                          <p><strong><i class="fas fa-chart-pie list-icon"></i> Всего обработано ZIMG:</strong> 10</p>
                          <p><strong><i class="fas fa-exclamation-triangle list-icon"></i> Требуют корректировок:</strong> 10</p>
                          <p><strong><i class="fas fa-check-circle list-icon"></i> Не требуют корректировок:</strong> 0</p>
                      
                   </div>
                   <div class="module-detailed-info">
                       <h3 style="display: flex; align-items: center; justify-content: space-between;">
                           <span><i class="fas fa-chart-bar"></i> Детальная информация и аналитика:</span>
                           
                       </h3>
                       
                            <div class="pie-chart-container">
                                <div class="pie-chart" style="background: conic-gradient(var(--status-warning) 0% 100.0%, var(--status-skipped) 100.0% 100%);">
                                </div>
                                <div class="pie-chart-legend">
                                    <p><span class="legend-color" style="background-color: var(--status-warning);"></span> Требуют корректировок: 10 (100.0%)</p>
                                    <p><span class="legend-color" style="background-color: var(--status-skipped);"></span> Не требуют корректировок: 0 (0.0%)</p>
                                    <p style="margin-top:15px;"><strong>Всего ZIMG: 10</strong></p>
                                </div>
                            </div>
                          
                   </div>
                 
                         
                        <div class="module-data-section">
                            <h3><i class="fas fa-tasks"></i> Сформированные действия:</h3>
                            <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать</button>
                            <div class="content-data-container" style="display: none;" data-filename="corrections_sequence.txt">
                                <button class="copy-btn" title="Скопировать"><i class="far fa-copy"></i></button>
                                <button class="download-btn" title="Скачать"><i class="fas fa-download"></i></button>
                                <pre class="content-pre-output">
ZIMG: 6180365230
Последовательность действий:
1. Пробить обратный чек к 1652300117600000266 - возврат
2. Пробить прямой чек продажи для ZIMG 6180365230 с SUM_MP = 514.8
--------------------------------------------------

ZIMG: 6180771107
Последовательность действий:
1. Пробить обратный чек к 313500111900000466 - возврат
2. Пробить прямой чек продажи для ZIMG 6180771107 с SUM_MP = 464.0
--------------------------------------------------

ZIMG: 6180859454
Последовательность действий:
1. Пробить обратный чек к 3782500116100001664 - возврат
2. Пробить прямой чек продажи для ZIMG 6180859454 с SUM_MP = 299.15
--------------------------------------------------

ZIMG: 6180898363
Последовательность действий:
1. Пробить обратный чек к 2464200116100002261 - возврат
2. Пробить прямой чек продажи для ZIMG 6180898363 с SUM_MP = 500.0
--------------------------------------------------

ZIMG: 6181025863
Последовательность действий:
1. Пробить обратный чек к 401000109800001829 - возврат
2. Пробить прямой чек продажи для ZIMG 6181025863 с SUM_MP = 448.4
--------------------------------------------------

ZIMG: 6181036475
Последовательность действий:
1. Пробить обратный чек к 4344600117800002569 - возврат
2. Пробить прямой чек продажи для ZIMG 6181036475 с SUM_MP = 523.05
--------------------------------------------------

ZIMG: 6181073902
Последовательность действий:
1. Пробить обратный чек к 512200111500003346 - возврат
2. Пробить прямой чек продажи для ZIMG 6181073902 с SUM_MP = 533.3
--------------------------------------------------

ZIMG: 6181105554
Последовательность действий:
1. Пробить обратный чек к 401000109400003522 - возврат
2. Пробить прямой чек продажи для ZIMG 6181105554 с SUM_MP = 282.0
--------------------------------------------------

ZIMG: 6181111655
Последовательность действий:
1. Пробить обратный чек к 313500111500001308 - возврат
2. Пробить прямой чек продажи для ZIMG 6181111655 с SUM_MP = 298.8
--------------------------------------------------

ZIMG: 6181117552
Последовательность действий:
1. Пробить обратный чек к 270500111600001035 - возврат
2. Пробить прямой чек продажи для ZIMG 6181117552 с SUM_MP = 694.4
--------------------------------------------------
</pre>
                            </div>
                        </div>
                    
                         
                        <div class="module-data-section">
                            <h3><i class="fas fa-search-plus"></i> Подробный анализ:</h3>
                            <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать</button>
                            <div class="content-data-container" style="display: none;">
                                <button class="copy-btn" title="Скопировать"><i class="far fa-copy"></i></button>
                                <pre class="content-pre-output">
Анализируем ZIMG: 6180365230
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
0  1652300117600000266   Продажа        514.8    140.4   374.4    514.8                  1

Итоговая сумма по ZIMG: 514.8

Транзакция для анализа: 1652300117600000266
Операция: Продажа
Суммы: SALESAMOUNT=514.8, SUM_OWN=140.4, SUM_MP=374.4, NEED_MP=514.8

Сформированные действия:
Пробить обратный чек к 1652300117600000266 - возврат
Пробить прямой чек продажи для ZIMG 6180365230 с SUM_MP = 514.8

Анализируем ZIMG: 6180771107
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
1  313500111900000466   Продажа        464.0     90.3   373.7    464.0                  1

Итоговая сумма по ZIMG: 464.0

Транзакция для анализа: 313500111900000466
Операция: Продажа
Суммы: SALESAMOUNT=464.0, SUM_OWN=90.3, SUM_MP=373.7, NEED_MP=464.0

Сформированные действия:
Пробить обратный чек к 313500111900000466 - возврат
Пробить прямой чек продажи для ZIMG 6180771107 с SUM_MP = 464.0

Анализируем ZIMG: 6180859454
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
2  3782500116100001664   Продажа       299.15    116.3  182.85   299.15                  1

Итоговая сумма по ZIMG: 299.15

Транзакция для анализа: 3782500116100001664
Операция: Продажа
Суммы: SALESAMOUNT=299.15, SUM_OWN=116.3, SUM_MP=182.85, NEED_MP=299.15

Сформированные действия:
Пробить обратный чек к 3782500116100001664 - возврат
Пробить прямой чек продажи для ZIMG 6180859454 с SUM_MP = 299.15

Анализируем ZIMG: 6180898363
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
3  2464200116100002261   Продажа        500.0    122.4   377.6    500.0                  1

Итоговая сумма по ZIMG: 500.0

Транзакция для анализа: 2464200116100002261
Операция: Продажа
Суммы: SALESAMOUNT=500.0, SUM_OWN=122.4, SUM_MP=377.6, NEED_MP=500.0

Сформированные действия:
Пробить обратный чек к 2464200116100002261 - возврат
Пробить прямой чек продажи для ZIMG 6180898363 с SUM_MP = 500.0

Анализируем ZIMG: 6181025863
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
4  401000109800001829   Продажа        448.4    140.4   308.0    448.4                  1

Итоговая сумма по ZIMG: 448.4

Транзакция для анализа: 401000109800001829
Операция: Продажа
Суммы: SALESAMOUNT=448.4, SUM_OWN=140.4, SUM_MP=308.0, NEED_MP=448.4

Сформированные действия:
Пробить обратный чек к 401000109800001829 - возврат
Пробить прямой чек продажи для ZIMG 6181025863 с SUM_MP = 448.4

Анализируем ZIMG: 6181036475
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
5  4344600117800002569   Продажа       783.05    540.8  242.25   523.05                  1

Итоговая сумма по ZIMG: 783.05

Транзакция для анализа: 4344600117800002569
Операция: Продажа
Суммы: SALESAMOUNT=783.05, SUM_OWN=540.8, SUM_MP=242.25, NEED_MP=523.05

Сформированные действия:
Пробить обратный чек к 4344600117800002569 - возврат
Пробить прямой чек продажи для ZIMG 6181036475 с SUM_MP = 523.05

Анализируем ZIMG: 6181073902
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
6  512200111500003346   Продажа        533.3    265.7   267.6    533.3                  1

Итоговая сумма по ZIMG: 533.3

Транзакция для анализа: 512200111500003346
Операция: Продажа
Суммы: SALESAMOUNT=533.3, SUM_OWN=265.7, SUM_MP=267.6, NEED_MP=533.3

Сформированные действия:
Пробить обратный чек к 512200111500003346 - возврат
Пробить прямой чек продажи для ZIMG 6181073902 с SUM_MP = 533.3

Анализируем ZIMG: 6181105554
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
7  401000109400003522   Продажа        282.0    126.0   156.0    282.0                  1

Итоговая сумма по ZIMG: 282.0

Транзакция для анализа: 401000109400003522
Операция: Продажа
Суммы: SALESAMOUNT=282.0, SUM_OWN=126.0, SUM_MP=156.0, NEED_MP=282.0

Сформированные действия:
Пробить обратный чек к 401000109400003522 - возврат
Пробить прямой чек продажи для ZIMG 6181105554 с SUM_MP = 282.0

Анализируем ZIMG: 6181111655
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
8  313500111500001308   Продажа        298.8    140.4   158.4    298.8                  1

Итоговая сумма по ZIMG: 298.8

Транзакция для анализа: 313500111500001308
Операция: Продажа
Суммы: SALESAMOUNT=298.8, SUM_OWN=140.4, SUM_MP=158.4, NEED_MP=298.8

Сформированные действия:
Пробить обратный чек к 313500111500001308 - возврат
Пробить прямой чек продажи для ZIMG 6181111655 с SUM_MP = 298.8

Анализируем ZIMG: 6181117552
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
9  270500111600001035   Продажа        694.4    219.2   475.2    694.4                  1

Итоговая сумма по ZIMG: 694.4

Транзакция для анализа: 270500111600001035
Операция: Продажа
Суммы: SALESAMOUNT=694.4, SUM_OWN=219.2, SUM_MP=475.2, NEED_MP=694.4

Сформированные действия:
Пробить обратный чек к 270500111600001035 - возврат
Пробить прямой чек продажи для ZIMG 6181117552 с SUM_MP = 694.4

Анализ завершен. Результаты сохранены в /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/output/corrections_sequence_77.txt

Статистика обработки:
Всего обработано ZIMG: 10
Требуют корректировок: 10
Не требуют корректировок: 0
</pre>
                            </div>
                        </div>
                    
                         
                         
                    <div class="module-log-section">
                        <h3><i class="far fa-file-alt"></i> Лог выполнения:</h3>
                        <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать Лог</button>
                        <div class="content-data-container" style="display: none;"><pre class="content-pre-output">INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/analyze_prepaid.py] Анализируем ZIMG: 6180365230
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
0  1652300117600000266   Продажа        514.8    140.4   374.4    514.8                  1
Итоговая сумма по ZIMG: 514.8
Транзакция для анализа: 1652300117600000266
Операция: Продажа
Суммы: SALESAMOUNT=514.8, SUM_OWN=140.4, SUM_MP=374.4, NEED_MP=514.8
Сформированные действия:
Пробить обратный чек к 1652300117600000266 - возврат
Пробить прямой чек продажи для ZIMG 6180365230 с SUM_MP = 514.8
Анализируем ZIMG: 6180771107
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
1  313500111900000466   Продажа        464.0     90.3   373.7    464.0                  1
Итоговая сумма по ZIMG: 464.0
Транзакция для анализа: 313500111900000466
Операция: Продажа
Суммы: SALESAMOUNT=464.0, SUM_OWN=90.3, SUM_MP=373.7, NEED_MP=464.0
Сформированные действия:
Пробить обратный чек к 313500111900000466 - возврат
Пробить прямой чек продажи для ZIMG 6180771107 с SUM_MP = 464.0
Анализируем ZIMG: 6180859454
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
2  3782500116100001664   Продажа       299.15    116.3  182.85   299.15                  1
Итоговая сумма по ZIMG: 299.15
Транзакция для анализа: 3782500116100001664
Операция: Продажа
Суммы: SALESAMOUNT=299.15, SUM_OWN=116.3, SUM_MP=182.85, NEED_MP=299.15
Сформированные действия:
Пробить обратный чек к 3782500116100001664 - возврат
Пробить прямой чек продажи для ZIMG 6180859454 с SUM_MP = 299.15
Анализируем ZIMG: 6180898363
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
3  2464200116100002261   Продажа        500.0    122.4   377.6    500.0                  1
Итоговая сумма по ZIMG: 500.0
Транзакция для анализа: 2464200116100002261
Операция: Продажа
Суммы: SALESAMOUNT=500.0, SUM_OWN=122.4, SUM_MP=377.6, NEED_MP=500.0
Сформированные действия:
Пробить обратный чек к 2464200116100002261 - возврат
Пробить прямой чек продажи для ZIMG 6180898363 с SUM_MP = 500.0
Анализируем ZIMG: 6181025863
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
4  401000109800001829   Продажа        448.4    140.4   308.0    448.4                  1
Итоговая сумма по ZIMG: 448.4
Транзакция для анализа: 401000109800001829
Операция: Продажа
Суммы: SALESAMOUNT=448.4, SUM_OWN=140.4, SUM_MP=308.0, NEED_MP=448.4
Сформированные действия:
Пробить обратный чек к 401000109800001829 - возврат
Пробить прямой чек продажи для ZIMG 6181025863 с SUM_MP = 448.4
Анализируем ZIMG: 6181036475
Все транзакции:
           TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
5  4344600117800002569   Продажа       783.05    540.8  242.25   523.05                  1
Итоговая сумма по ZIMG: 783.05
Транзакция для анализа: 4344600117800002569
Операция: Продажа
Суммы: SALESAMOUNT=783.05, SUM_OWN=540.8, SUM_MP=242.25, NEED_MP=523.05
Сформированные действия:
Пробить обратный чек к 4344600117800002569 - возврат
Пробить прямой чек продажи для ZIMG 6181036475 с SUM_MP = 523.05
Анализируем ZIMG: 6181073902
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
6  512200111500003346   Продажа        533.3    265.7   267.6    533.3                  1
Итоговая сумма по ZIMG: 533.3
Транзакция для анализа: 512200111500003346
Операция: Продажа
Суммы: SALESAMOUNT=533.3, SUM_OWN=265.7, SUM_MP=267.6, NEED_MP=533.3
Сформированные действия:
Пробить обратный чек к 512200111500003346 - возврат
Пробить прямой чек продажи для ZIMG 6181073902 с SUM_MP = 533.3
Анализируем ZIMG: 6181105554
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
7  401000109400003522   Продажа        282.0    126.0   156.0    282.0                  1
Итоговая сумма по ZIMG: 282.0
Транзакция для анализа: 401000109400003522
Операция: Продажа
Суммы: SALESAMOUNT=282.0, SUM_OWN=126.0, SUM_MP=156.0, NEED_MP=282.0
Сформированные действия:
Пробить обратный чек к 401000109400003522 - возврат
Пробить прямой чек продажи для ZIMG 6181105554 с SUM_MP = 282.0
Анализируем ZIMG: 6181111655
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
8  313500111500001308   Продажа        298.8    140.4   158.4    298.8                  1
Итоговая сумма по ZIMG: 298.8
Транзакция для анализа: 313500111500001308
Операция: Продажа
Суммы: SALESAMOUNT=298.8, SUM_OWN=140.4, SUM_MP=158.4, NEED_MP=298.8
Сформированные действия:
Пробить обратный чек к 313500111500001308 - возврат
Пробить прямой чек продажи для ZIMG 6181111655 с SUM_MP = 298.8
Анализируем ZIMG: 6181117552
Все транзакции:
          TRANSNUMBER OPERATION  SALESAMOUNT  SUM_OWN  SUM_MP  NEED_MP  TRANSACTION_COUNT
9  270500111600001035   Продажа        694.4    219.2   475.2    694.4                  1
Итоговая сумма по ZIMG: 694.4
Транзакция для анализа: 270500111600001035
Операция: Продажа
Суммы: SALESAMOUNT=694.4, SUM_OWN=219.2, SUM_MP=475.2, NEED_MP=694.4
Сформированные действия:
Пробить обратный чек к 270500111600001035 - возврат
Пробить прямой чек продажи для ZIMG 6181117552 с SUM_MP = 694.4
Анализ завершен. Результаты сохранены в /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/output/corrections_sequence_77.txt
Статистика обработки:
Всего обработано ZIMG: 10
Требуют корректировок: 10
Не требуют корректировок: 0
Подробный лог анализа сохранен в /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/output/analysis_log_77.txt</pre></div>
                    </div>
                
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             
                 <div id="module-2-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Получение ссылок на чеки ОФД - <span class="module-status status-skipped">ПРОПУЩЕН</span></h2>
                         
                   <div class="module-summary">
                       <h3><i class="fas fa-ban"></i> Итоги модуля:</h3>
                       <p>Модуль был пропущен во время этого выполнения.</p>
                   </div>
                         
                         
                         
                         
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             
                 <div id="sap-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Данные позиций заказа из SAP - <span class="module-status status-success">УСПЕШНО</span></h2>
                         
                   <div class="module-summary">
                       <h3><i class="fas fa-poll"></i> Итоги модуля:</h3>
                       
                         <p><i class="fas fa-check-circle list-icon"></i> Модуль успешно выполнен.</p>
                         <p><strong><i class="far fa-clock list-icon"></i> Время работы модуля:</strong> 18.83 секунд</p>
                         <p><strong><i class="fas fa-clipboard-check list-icon"></i> Проанализировано заказов:</strong> 10</p>
                         <p><strong><i class="fas fa-search-minus list-icon"></i> Не найдено заказов:</strong> 0</p>
                     
                   </div>
                   <div class="module-detailed-info">
                       <h3 style="display: flex; align-items: center; justify-content: space-between;">
                           <span><i class="fas fa-chart-bar"></i> Детальная информация и аналитика:</span>
                           
                               <div class="filter-container">
                                   <input type="text" class="filter-input" id="cash-data-filter-input" placeholder="Фильтр по Заказу...">
                                   <button class="filter-button" id="cash-data-filter-button"><i class="fas fa-search"></i></button>
                               </div>
                           
                       </h3>
                       
                                 <div class="cash-data-table-container">
                                     <table class="cash-data-table" id="cash-data-table">
                                         <thead>
                                             <tr>
                                                 <th>Заказ</th><th>Данные позиций</th>
                                             </tr>
                                         </thead>
                                         <tbody>
                                             
                                                     <tr>
                                                         <td class="order-number-column">6180365230</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000916874<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 2338999001<br>
                                                                                     <strong>Вендор:</strong> ИП Рашидов Аслан Кулумбекович<br>
                                                                                     <strong>Телефон:</strong> +79164359639<br>
                                                                                     <strong>ИНН:</strong> 201677621112
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6180771107</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000332939<br>
                                                                                     <strong>Вендор:</strong> ООО «Торговый Дом «Эксмо»<br>
                                                                                     <strong>Телефон:</strong> +79263755159<br>
                                                                                     <strong>ИНН:</strong> 7706514755
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000845520<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000993968<br>
                                                                                     <strong>Вендор:</strong> ООО "АЛЬ ПАКО"<br>
                                                                                     <strong>Телефон:</strong> +79188542511<br>
                                                                                     <strong>ИНН:</strong> 6145004465
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6180859454</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1001025908<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000711749<br>
                                                                                     <strong>Вендор:</strong> ИП Казарян Эдгар Гарегинович<br>
                                                                                     <strong>Телефон:</strong> +79154377743<br>
                                                                                     <strong>ИНН:</strong> 772875736404
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6180898363</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 2371632002<br>
                                                                                     <strong>Вендор:</strong> ООО "Концепт Груп"<br>
                                                                                     <strong>Телефон:</strong> +79219707655<br>
                                                                                     <strong>ИНН:</strong> 7801506440
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1001044487<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000937956<br>
                                                                                     <strong>Вендор:</strong> ООО "Амидаглобал"<br>
                                                                                     <strong>Телефон:</strong> +79152962868<br>
                                                                                     <strong>ИНН:</strong> 9723073215
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181025863</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000916876<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000397063<br>
                                                                                     <strong>Вендор:</strong> ООО "АЛЬ ПАКО"<br>
                                                                                     <strong>Телефон:</strong> +79188542511<br>
                                                                                     <strong>ИНН:</strong> 6145004465
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181036475</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000940617<br>
                                                                                     <strong>Вендор:</strong> ООО «Дрофа-Медиа»<br>
                                                                                     <strong>Телефон:</strong> +74957950553<br>
                                                                                     <strong>ИНН:</strong> 7718167143
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 106059570<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000894029<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 103870578<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000916876<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181073902</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000671103<br>
                                                                                     <strong>Вендор:</strong> ООО «Дрофа-Медиа»<br>
                                                                                     <strong>Телефон:</strong> +74957950553<br>
                                                                                     <strong>ИНН:</strong> 7718167143
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000808288<br>
                                                                                     <strong>Вендор:</strong> Индивидуальный предприниматель Агли уллин Линар Раилевич<br>
                                                                                     <strong>Телефон:</strong> 89096799993<br>
                                                                                     <strong>ИНН:</strong> 636923053262
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000752245<br>
                                                                                     <strong>Вендор:</strong> Индивидуальный предприниматель Агли уллин Линар Раилевич<br>
                                                                                     <strong>Телефон:</strong> 89096799993<br>
                                                                                     <strong>ИНН:</strong> 636923053262
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181105554</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000592625<br>
                                                                                     <strong>Вендор:</strong> Индивидуальный предприниматель Агли уллин Линар Раилевич<br>
                                                                                     <strong>Телефон:</strong> 89096799993<br>
                                                                                     <strong>ИНН:</strong> 636923053262
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1001001314<br>
                                                                                     <strong>Вендор:</strong> ООО "Клёпа"<br>
                                                                                     <strong>Телефон:</strong> +79257247500<br>
                                                                                     <strong>ИНН:</strong> 6205000740
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1001001316<br>
                                                                                     <strong>Вендор:</strong> ООО "Клёпа"<br>
                                                                                     <strong>Телефон:</strong> +79257247500<br>
                                                                                     <strong>ИНН:</strong> 6205000740
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181111655</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000767195<br>
                                                                                     <strong>Вендор:</strong> ООО "РДЛГ"<br>
                                                                                     <strong>Телефон:</strong> +74957845557<br>
                                                                                     <strong>ИНН:</strong> 7728354047
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000767482<br>
                                                                                     <strong>Вендор:</strong> ООО "РДЛГ"<br>
                                                                                     <strong>Телефон:</strong> +74957845557<br>
                                                                                     <strong>ИНН:</strong> 7728354047
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1001025022<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 2364308003<br>
                                                                                     <strong>Вендор:</strong> ООО "Волга-М"<br>
                                                                                     <strong>Телефон:</strong> +79033202388<br>
                                                                                     <strong>ИНН:</strong> 7326032480
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1001025413<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181117552</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000944158<br>
                                                                                     <strong>Вендор:</strong> ООО «СИМАОПТ»<br>
                                                                                     <strong>Телефон:</strong> +79122509748<br>
                                                                                     <strong>ИНН:</strong> 6679080455
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000835627<br>
                                                                                     <strong>Вендор:</strong> ООО "Диамант ЗОО"<br>
                                                                                     <strong>Телефон:</strong> +79175039411<br>
                                                                                     <strong>ИНН:</strong> 7728602099
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 1000712190<br>
                                                                                     <strong>Вендор:</strong> ООО «ВИЛИНА»<br>
                                                                                     <strong>Телефон:</strong> +7166451920<br>
                                                                                     <strong>ИНН:</strong> 7804099377
                                                                                 </li>
                                                                             
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                                     <strong>Вендор:</strong> Н/Д<br>
                                                                                     <strong>Телефон:</strong> Н/Д<br>
                                                                                     <strong>ИНН:</strong> Н/Д
                                                                                 </li>
                                                                             </ul></td>
                                                     </tr>
                                                 
                                         </tbody>
                                     </table>
                                 </div>
                             
                   </div>
                 
                         
                         
                         
                         
                    <div class="module-log-section">
                        <h3><i class="far fa-file-alt"></i> Лог выполнения:</h3>
                        <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать Лог</button>
                        <div class="content-data-container" style="display: none;"><pre class="content-pre-output">INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] {"level":"info","message":"Parsing VBAP data from /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/Input/vbap_n.txt, found 2934 records","timestamp":"2025-05-19T01:24:02.486Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] {"level":"info","message":"Parsing cash data from /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/Input/cash_2.txt, found 1586 records","timestamp":"2025-05-19T01:24:02.489Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 2 with data for VBELN 6180365230
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 3 with data for VBELN 6180771107
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 4 with data for VBELN 6180859454
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 5 with data for VBELN 6180898363
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 6 with data for VBELN 6181025863
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 7 with data for VBELN 6181036475
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 8 with data for VBELN 6181073902
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 9 with data for VBELN 6181105554
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 10 with data for VBELN 6181111655
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Updated row 11 with data for VBELN 6181117552
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] --- Execution Summary ---
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_cashdata.js] Время работы модуля: 18.83 секунд
Количество проанализированных заказов: 10
Количество не найденных заказов: 0
-------------------------
Processing completed</pre></div>
                    </div>
                
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             
                 <div id="midas-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Данные позиций заказа из MIDAS - <span class="module-status status-failure">ОШИБКА</span></h2>
                         
                   <div class="module-summary">
                       <h3><i class="fas fa-exclamation-circle"></i> Итоги модуля:</h3>
                       <p>Модуль завершился с ошибкой.</p>
                   </div>
                         
                         
                         
                         
                    <div class="module-log-section">
                        <h3><i class="far fa-file-alt"></i> Лог выполнения:</h3>
                        <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать Лог</button>
                        <div class="content-data-container" style="display: none;"><pre class="content-pre-output">INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Parsing VBAP data from /Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/Input/vbap_n.txt, found 2934 records","timestamp":"2025-05-19T01:24:21.963Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Retrieved 10 rows from Google Sheets","timestamp":"2025-05-19T01:24:22.458Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 2 with VBELN 6180365230","timestamp":"2025-05-19T01:24:22.459Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:22.589Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 2 with data for VBELN 6180365230","timestamp":"2025-05-19T01:24:23.063Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 3 with VBELN 6180771107","timestamp":"2025-05-19T01:24:24.066Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:24.136Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 3 with data for VBELN 6180771107","timestamp":"2025-05-19T01:24:24.523Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 4 with VBELN 6180859454","timestamp":"2025-05-19T01:24:25.525Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:25.595Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 4 with data for VBELN 6180859454","timestamp":"2025-05-19T01:24:26.515Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 5 with VBELN 6180898363","timestamp":"2025-05-19T01:24:27.517Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:27.586Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 5 with data for VBELN 6180898363","timestamp":"2025-05-19T01:24:28.532Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 6 with VBELN 6181025863","timestamp":"2025-05-19T01:24:29.534Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:29.609Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 6 with data for VBELN 6181025863","timestamp":"2025-05-19T01:24:29.930Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 7 with VBELN 6181036475","timestamp":"2025-05-19T01:24:30.933Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:31.004Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 7 with data for VBELN 6181036475","timestamp":"2025-05-19T01:24:31.937Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 8 with VBELN 6181073902","timestamp":"2025-05-19T01:24:32.939Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:33.014Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 8 with data for VBELN 6181073902","timestamp":"2025-05-19T01:24:33.358Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 9 with VBELN 6181105554","timestamp":"2025-05-19T01:24:34.360Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:34.430Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 9 with data for VBELN 6181105554","timestamp":"2025-05-19T01:24:35.379Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 10 with VBELN 6181111655","timestamp":"2025-05-19T01:24:36.381Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:36.452Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 10 with data for VBELN 6181111655","timestamp":"2025-05-19T01:24:37.391Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing row 11 with VBELN 6181117552","timestamp":"2025-05-19T01:24:38.394Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"error","message":"Error fetching vendor data:","timestamp":"2025-05-19T01:24:38.464Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Updated row 11 with data for VBELN 6181117552","timestamp":"2025-05-19T01:24:39.375Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] --- Execution Summary ---
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] Время работы модуля: 18.42 секунд
Количество проанализированных заказов: 10
Количество не найденных заказов: 0
-------------------------
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/fill_midas_pos.js] {"level":"info","message":"Processing completed","timestamp":"2025-05-19T01:24:40.378Z"}

Модуль имеет ошибку в логах, хотя был отмечен как успешно завершенный</pre></div>
                    </div>
                
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             
                 <div id="midas-erp-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Сравнение позиций заказа MIDAS и ERP - <span class="module-status status-success">УСПЕШНО</span></h2>
                         
                   <div class="module-summary">
                       <h3><i class="fas fa-poll"></i> Итоги модуля:</h3>
                       
                         <p><i class="fas fa-check-circle list-icon"></i> Модуль успешно выполнен.</p>
                         <p><strong><i class="far fa-clock list-icon"></i> Время работы модуля:</strong> 15.75 секунд</p>
                         <p><strong><i class="fas fa-clipboard-check list-icon"></i> Проанализировано заказов:</strong> 10</p>
                         <p><strong><i class="fas fa-search-minus list-icon"></i> Не найдено заказов:</strong> 0</p>
                     
                   </div>
                   <div class="module-detailed-info">
                       <h3 style="display: flex; align-items: center; justify-content: space-between;">
                           <span><i class="fas fa-chart-bar"></i> Детальная информация и аналитика:</span>
                           
                               <div class="filter-container">
                                   <input type="text" class="filter-input" id="comparison-filter-input" placeholder="Фильтр по Заказу...">
                                   <button class="filter-button" id="comparison-filter-button"><i class="fas fa-search"></i></button>
                               </div>
                           
                       </h3>
                       
                                 <div class="comparison-table-container">
                                     <table class="comparison-table" id="comparison-table">
                                         <thead>
                                             <tr>
                                                 <th>Заказ</th><th>Данные позиций</th>
                                             </tr>
                                         </thead>
                                         <tbody>
                                             
                                                     <tr>
                                                         <td class="order-number-column">6180365230</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000916874<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 2338999001<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6180771107</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000332939<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000845520<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000993968<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6180859454</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1001025908<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000711749<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6180898363</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 2371632002<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1001044487<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000937956<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181025863</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000916876<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000397063<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181036475</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000940617<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 106059570<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000894029<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 103870578<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000916876<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181073902</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000671103<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000808288<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000752245<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181105554</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000592625<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1001001314<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1001001316<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181111655</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000767195<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000767482<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1001025022<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 2364308003<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1001025413<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                                     <tr>
                                                         <td class="order-number-column">6181117552</td><td ><ul class="position-data-list">
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000944158<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000835627<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item item-with-issues">
                                                                                     <strong>Код товара:</strong> 1000712190<br>
                                                                             <strong>Вендор:</strong> <span class="issue-text">отсутствует vendorName</span><br><strong>Телефон:</strong> <span class="issue-text">отсутствует vendorPhone</span><br><strong>ИНН:</strong> <span class="issue-text">отсутствует vendorInn</span></li>
                                                                                 <li class="position-data-item">
                                                                                     <strong>Код товара:</strong> 8000000211<br>
                                                                             <strong>Вендор:</strong> <span class="ok-text">Совпадает</span><br><strong>Телефон:</strong> <span class="ok-text">Совпадает</span><br><strong>ИНН:</strong> <span class="ok-text">Совпадает</span></li></ul></td>
                                                     </tr>
                                                 
                                         </tbody>
                                     </table>
                                 </div>
                             
                   </div>
                 
                         
                         
                         
                         
                    <div class="module-log-section">
                        <h3><i class="far fa-file-alt"></i> Лог выполнения:</h3>
                        <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать Лог</button>
                        <div class="content-data-container" style="display: none;"><pre class="content-pre-output">INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Retrieved 10 rows from Google Sheets","timestamp":"2025-05-19T01:24:42.427Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 2 for comparison","timestamp":"2025-05-19T01:24:42.430Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 2 with comparison results","timestamp":"2025-05-19T01:24:42.777Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 3 for comparison","timestamp":"2025-05-19T01:24:43.778Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 3 with comparison results","timestamp":"2025-05-19T01:24:44.095Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 4 for comparison","timestamp":"2025-05-19T01:24:45.097Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 4 with comparison results","timestamp":"2025-05-19T01:24:46.029Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 5 for comparison","timestamp":"2025-05-19T01:24:47.031Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 5 with comparison results","timestamp":"2025-05-19T01:24:47.371Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 6 for comparison","timestamp":"2025-05-19T01:24:48.373Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 6 with comparison results","timestamp":"2025-05-19T01:24:48.690Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 7 for comparison","timestamp":"2025-05-19T01:24:49.692Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 7 with comparison results","timestamp":"2025-05-19T01:24:50.020Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 8 for comparison","timestamp":"2025-05-19T01:24:51.022Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 8 with comparison results","timestamp":"2025-05-19T01:24:51.420Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 9 for comparison","timestamp":"2025-05-19T01:24:52.422Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 9 with comparison results","timestamp":"2025-05-19T01:24:52.827Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 10 for comparison","timestamp":"2025-05-19T01:24:53.829Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 10 with comparison results","timestamp":"2025-05-19T01:24:54.753Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing row 11 for comparison","timestamp":"2025-05-19T01:24:55.755Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Updated row 11 with comparison results","timestamp":"2025-05-19T01:24:56.081Z"}
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] --- Execution Summary ---
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] Время работы модуля: 15.75 секунд
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] Количество проанализированных заказов: 10
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] Количество не найденных заказов: 0
-------------------------
INFO: [/Users/marina/Library/Mobile Documents/com~apple~CloudDocs/DM/MIDAS_ERP/scripts/compare_midas_erp.js] {"level":"info","message":"Processing completed","timestamp":"2025-05-19T01:24:57.085Z"}</pre></div>
                    </div>
                
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             
                 <div id="module-6-content" class="report-content">
                     <div class="section">
                         <h2><i class="fas fa-caret-right"></i> Анализ расхождений по вендорам - <span class="module-status status-running">ПРОПУЩЕН</span></h2>
                         
                         
                         
                         
                         
                    <div class="module-log-section">
                        <h3><i class="far fa-file-alt"></i> Лог выполнения:</h3>
                        <button class="toggle-content-btn"><i class="fas fa-chevron-down"></i> Показать Лог</button>
                        <div class="content-data-container" style="display: none;"><pre class="content-pre-output">INFO: 
=== ОТЧЕТ ЗАВЕРШЕН ===
INFO: Время начала: 5/19/2025, 4:23:56 AM
INFO: Время окончания: 5/19/2025, 4:24:58 AM
INFO: Общая продолжительность: 62.28 секунд
INFO: ===============================</pre></div>
                    </div>
                
                     </div>
                     <div class="tab-navigation-arrows">
                         <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                         <button class="nav-arrow-btn next" data-direction="next"><i class="fas fa-arrow-right"></i> Следующая</button>
                     </div>
                 </div>
             

        <div id="additional-info-content" class="report-content">
            <div class="section">
                <h2><i class="fas fa-info-circle"></i> Полезные ссылки и информация</h2>
                
                <div class="info-block">
                    <h3><i class="fas fa-thumbtack"></i> Задача:</h3>
                    <p><a href="https://detmir.atlassian.net/browse/OPER-13615" target="_blank">OPER-13615</a></p>
                </div>

                <div class="info-block">
                    <h3><i class="fab fa-telegram-plane"></i> ТГ бот для формирования отчета:</h3>
                    <p><a href="https://t.me/Mid_Report_bot" target="_blank">@Mid_Report_bot</a></p>
                </div>

                <div class="info-block">
                    <h3><i class="fab fa-confluence"></i> Ссылка на гайд в Confluence:</h3>
                    <p><a href="https://detmir.atlassian.net/wiki/spaces/~627bc5a1b249c0006f9614bd/pages/5463081242/FS.OPER-13615?atlOrigin=eyJpIjoiMWI0YTdkMTcxYTg2NGUyMmI3ZWI4YmYzZWNlMzZkODgiLCJwIjoiYyJ9" target="_blank">Гайд по FS.OPER-13615</a></p>
                </div>
                
                <div class="important-card">
                    <h4><i class="fas fa-exclamation-triangle"></i> Важно</h4>
                    <ul>
                        <li>В файле представлена пошаговая инструкция как править каждый заказ, если заказов меньше чем в исходном файле - это нормально, так как часть транзакций перекрывают друг друга.</li>
                        <li>Слова "обратный чек" обозначают что чек будет 1:1 как ошибочный (с теми же тегами поставщика).</li>
                    </ul>
                </div>

                <h3><i class="fas fa-robot"></i> Как пользоваться ботом</h3>
                <div class="info-block">
                     <p><strong>Инструкция:</strong> <a href="https://detmir.atlassian.net/wiki/spaces/~627bc5a1b249c0006f9614bd/pages/5489263120/Mid_Report_bot?atlOrigin=eyJpIjoiOGNkMjZhYjI2MDczNGU3OWEwYTZkZmVkZTlkYzk1OGYiLCJwIjoiYyJ9" target="_blank">Mid_Report_bot Confluence Guide</a></p>
                     <p><strong>Краткое описание:</strong> (список будет позже наполнен)</p>
                     <ol style="margin-left: 20px; list-style-type: decimal;">
                        <li>...</li>
                        <li>...</li>
                    </ol>
                </div>
            </div>
            <div class="tab-navigation-arrows">
                <button class="nav-arrow-btn prev" data-direction="prev"><i class="fas fa-arrow-left"></i> Предыдущая</button>
                <button class="nav-arrow-btn next" data-direction="next" style="display: none;"><i class="fas fa-arrow-right"></i> Следующая</button>
            </div>
        </div>

    </div>

     <script>
         document.addEventListener('DOMContentLoaded', () => {
             console.log('DOM fully loaded and parsed');
             const tabs = document.querySelectorAll('.tab');
             const reportContents = document.querySelectorAll('.report-content');
             const toggleContentButtons = document.querySelectorAll('.toggle-content-btn'); // Updated selector
             const detailArrows = document.querySelectorAll('.detail-arrow');
             const copyButtons = document.querySelectorAll('.copy-btn'); // Updated selector for all copy buttons
             const downloadButtons = document.querySelectorAll('.download-btn'); // Selector for download buttons
             const navArrowButtons = document.querySelectorAll('.nav-arrow-btn');
             
             let orderedTabTargets = [];

             console.log('Tabs found:', tabs.length);
             console.log('Report contents found:', reportContents.length);
             console.log('Toggle Content buttons found:', toggleContentButtons.length);
             console.log('Detail arrows found:', detailArrows.length);
             console.log('Copy buttons found:', copyButtons.length);
             console.log('Download buttons found:', downloadButtons.length);
             console.log('Nav Arrow buttons found:', navArrowButtons.length);

            const updateNavigationArrows = (activeTargetId) => {
                const currentIndex = orderedTabTargets.indexOf(activeTargetId);
                navArrowButtons.forEach(btn => {
                    const parentContent = btn.closest('.report-content');
                    if (parentContent && parentContent.id === activeTargetId) {
                        if (btn.classList.contains('prev')) {
                            btn.style.display = currentIndex > 0 ? 'inline-flex' : 'none';
                        }
                        if (btn.classList.contains('next')) {
                            btn.style.display = currentIndex < orderedTabTargets.length - 1 ? 'inline-flex' : 'none';
                        }
                    } else { 
                        // This handles arrows in non-active tabs, if they are ever visible (they shouldn't be due to .report-content display:none)
                         // but as a safeguard, hide them if their parent is not active.
                        // btn.style.display = 'none'; 
                    }
                });
            };

             const showContent = (targetId) => {
                console.log('showContent called with targetId:', targetId);
                tabs.forEach(t => t.classList.remove('active'));
                reportContents.forEach(c => c.classList.remove('active'));

                const targetTabButton = document.querySelector('.tab[data-target="' + targetId + '"]');
                console.log('Target tab button found for ' + targetId + ':', targetTabButton);
                if (targetTabButton) {
                    targetTabButton.classList.add('active');
                }

                const targetContentElement = document.getElementById(targetId);
                console.log('Target content element found for ' + targetId + ':', targetContentElement);
                if (targetContentElement) {
                    targetContentElement.classList.add('active');
                } else {
                    console.log('Fallback: targetId "' + targetId + '" not found, activating summary.');
                    const summaryContent = document.getElementById('summary-content');
                    if (summaryContent) { 
                        summaryContent.classList.add('active');
                    }
                    const summaryTab = document.querySelector('.tab[data-target="summary-content"]');
                    if (summaryTab) { 
                        summaryTab.classList.add('active');
                    }
                    targetId = 'summary-content'; // Update targetId to summary for arrow update
                }
                updateNavigationArrows(targetId);
            };

            // Initialize orderedTabTargets after DOM is parsed
            document.querySelectorAll('.tabs .tab').forEach(tab => orderedTabTargets.push(tab.dataset.target));
            console.log('Ordered tab targets:', orderedTabTargets);

             tabs.forEach(tab => {
                 tab.addEventListener('click', function() { 
                     const targetId = this.getAttribute('data-target');
                     console.log('Tab clicked. data-target:', targetId);
                     showContent(targetId);
                     try {
                        if (history.pushState) {
                           history.pushState(null, null, '#' + targetId);
                        } else {
                           window.location.hash = '#' + targetId;
                        }
                     } catch (e) {
                        window.location.hash = '#' + targetId;
                     }
                 });
             });

              // Event listeners for all toggle content buttons
              toggleContentButtons.forEach(button => {
                  button.addEventListener('click', () => {
                      const dataContainer = button.nextElementSibling;
                      const baseText = button.textContent.replace(/Показать|Скрыть/g, '').trim();

                      button.innerHTML = ''; // Clear existing content
                      const fragment = document.createDocumentFragment();
                      const newIcon = document.createElement('i');

                      if (dataContainer.style.display === 'none' || dataContainer.style.display === '') {
                          dataContainer.style.display = 'block';
                          newIcon.className = 'fas fa-chevron-up';
                          fragment.appendChild(newIcon);
                          fragment.appendChild(document.createTextNode(' Скрыть ' + baseText));
                      } else {
                          dataContainer.style.display = 'none';
                          newIcon.className = 'fas fa-chevron-down';
                          fragment.appendChild(newIcon);
                          fragment.appendChild(document.createTextNode(' Показать ' + baseText));
                      }
                      button.appendChild(fragment);
                  });
              });

              // Event listeners for all copy buttons
              copyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const dataContainer = button.closest('.content-data-container'); // Use generic class
                    if (dataContainer) {
                        const preElement = dataContainer.querySelector('.content-pre-output'); // Use generic class
                        if (preElement) {
                            navigator.clipboard.writeText(preElement.textContent).then(() => {
                                const originalIcon = button.innerHTML;
                                button.innerHTML = '<i class="fas fa-check"></i> Скопировано!';
                                setTimeout(() => {
                                    button.innerHTML = originalIcon;
                                }, 2000);
                            }).catch(err => {
                                console.error('Failed to copy text: ', err);
                                alert('Не удалось скопировать текст.');
                            });
                        }
                    }
                });
              });

              downloadButtons.forEach(button => {
                  button.addEventListener('click', () => {
                    const dataContainer = button.closest('.content-data-container');
                    if (dataContainer) {
                        const preElement = dataContainer.querySelector('.content-pre-output');
                        const filename = dataContainer.dataset.filename || 'download.txt'; // Get filename from data attribute
                        if (preElement) {
                            const textToDownload = preElement.textContent;
                            const blob = new Blob([textToDownload], { type: 'text/plain' });
                            const url = URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        }
                    }
                  });
              });

              if (window.location.hash) {
                  const targetIdFromHash = window.location.hash.substring(1);
                  console.log('Initial load with hash:', targetIdFromHash);
                  if (document.getElementById(targetIdFromHash) && document.querySelector('.tab[data-target="' + targetIdFromHash + '"]')) {
                     showContent(targetIdFromHash);
                  } else {
                      console.log('Hash target not found or invalid, defaulting to summary.');
                      showContent('summary-content');
                  }
              } else {
                  console.log('Initial load, no hash, defaulting to summary.');
                  showContent('summary-content');
              }

            navArrowButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const direction = this.dataset.direction;
                    const currentActiveContent = document.querySelector('.report-content.active');
                    if (!currentActiveContent) return;

                    const currentTargetId = currentActiveContent.id;
                    const currentIndex = orderedTabTargets.indexOf(currentTargetId);

                    let nextIndex;
                    if (direction === 'prev' && currentIndex > 0) {
                        nextIndex = currentIndex - 1;
                    } else if (direction === 'next' && currentIndex < orderedTabTargets.length - 1) {
                        nextIndex = currentIndex + 1;
                    }

                    if (nextIndex !== undefined && orderedTabTargets[nextIndex]) {
                        const nextTargetId = orderedTabTargets[nextIndex];
                        showContent(nextTargetId);
                        try {
                            if (history.pushState) {
                                history.pushState(null, null, '#' + nextTargetId);
                            } else {
                                window.location.hash = '#' + nextTargetId;
                            }
                        } catch (e) {
                            window.location.hash = '#' + nextTargetId;
                        }
                    }
                });
            });

            // OFD Table Filtering Logic
            const ofdFilterInput = document.getElementById('ofd-filter-input');
            const ofdFilterButton = document.getElementById('ofd-filter-button');
            const ofdTableBody = document.querySelector('#ofd-links-table tbody'); // Assuming id is on table
            const noDataMessageOfd = document.createElement('p');
            noDataMessageOfd.textContent = 'Нет данных по заданному фильтру.';
            noDataMessageOfd.style.textAlign = 'center';
            noDataMessageOfd.style.padding = '10px';
            noDataMessageOfd.style.display = 'none'; // Initially hidden
            
            // Find the container for the OFD table and append the message
            const ofdTableContainer = document.querySelector('.ofd-links-table-container');
            if (ofdTableContainer) {
                ofdTableContainer.parentNode.insertBefore(noDataMessageOfd, ofdTableContainer.nextSibling);
            }
            
            const applyOfdFilter = () => {
                 console.log('Applying OFD filter...');
                if (!ofdTableBody) return;
                
                const filterText = ofdFilterInput.value.toLowerCase();
                let foundMatch = false;
                
                Array.from(ofdTableBody.children).forEach(row => {
                     // Assuming 'Заказ' is the first column (index 0)
                    const orderCell = row.children[0];
                    if (orderCell) {
                        const orderText = orderCell.textContent.toLowerCase();
                        if (orderText.includes(filterText)) {
                            row.style.display = '';
                            foundMatch = true;
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
                
                // Show/hide the no data message
                noDataMessageOfd.style.display = foundMatch ? 'none' : 'block';
            };
            
            if (ofdFilterButton) {
                 ofdFilterButton.addEventListener('click', applyOfdFilter);
            }
            
            // Optional: Allow filtering on Enter key press in the input field
            if (ofdFilterInput) {
                ofdFilterInput.addEventListener('keypress', (event) => {
                    if (event.key === 'Enter') {
                        event.preventDefault(); // Prevent form submission
                        applyOfdFilter();
                    }
                });
            }
            
            // Cash Data Table Filtering Logic
            const cashDataFilterInput = document.getElementById('cash-data-filter-input');
            const cashDataFilterButton = document.getElementById('cash-data-filter-button');
            const cashDataTableBody = document.querySelector('#cash-data-table tbody');
            const noDataMessageCash = document.createElement('p');
            noDataMessageCash.textContent = 'Нет данных по заданному фильтру.';
            noDataMessageCash.style.textAlign = 'center';
            noDataMessageCash.style.padding = '10px';
            noDataMessageCash.style.display = 'none'; // Initially hidden
            
            // Find the container for the Cash Data table and append the message
            const cashDataTableContainer = document.querySelector('.cash-data-table-container');
            if (cashDataTableContainer) {
                cashDataTableContainer.parentNode.insertBefore(noDataMessageCash, cashDataTableContainer.nextSibling);
            }
            
            const applyCashDataFilter = () => {
                console.log('Applying Cash Data filter...');
                if (!cashDataTableBody) return;
                
                const filterText = cashDataFilterInput.value.toLowerCase();
                let foundMatch = false;
                
                Array.from(cashDataTableBody.children).forEach(row => {
                    // Assuming 'Заказ' is the first column (index 0)
                    const orderCell = row.children[0];
                    if (orderCell) {
                        const orderText = orderCell.textContent.toLowerCase();
                        if (orderText.includes(filterText)) {
                            row.style.display = '';
                            foundMatch = true;
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
                
                // Show/hide the no data message
                noDataMessageCash.style.display = foundMatch ? 'none' : 'block';
            };
            
            if (cashDataFilterButton) {
                cashDataFilterButton.addEventListener('click', applyCashDataFilter);
            }
            
            // Optional: Allow filtering on Enter key press in the input field
            if (cashDataFilterInput) {
                cashDataFilterInput.addEventListener('keypress', (event) => {
                    if (event.key === 'Enter') {
                        event.preventDefault(); // Prevent form submission
                        applyCashDataFilter();
                    }
                });
            }
            
            // Comparison Table Filtering Logic
            const comparisonFilterInput = document.getElementById('comparison-filter-input');
            const comparisonFilterButton = document.getElementById('comparison-filter-button');
            const comparisonTableBody = document.querySelector('#comparison-table tbody');
            const noDataMessageComparison = document.createElement('p');
            noDataMessageComparison.textContent = 'Нет данных по заданному фильтру.';
            noDataMessageComparison.style.textAlign = 'center';
            noDataMessageComparison.style.padding = '10px';
            noDataMessageComparison.style.display = 'none'; // Initially hidden
            
            // Find the container for the Comparison table and append the message
            const comparisonTableContainer = document.querySelector('.comparison-table-container');
            if (comparisonTableContainer) {
                comparisonTableContainer.parentNode.insertBefore(noDataMessageComparison, comparisonTableContainer.nextSibling);
            }
            
            const applyComparisonFilter = () => {
                console.log('Applying Comparison filter...');
                if (!comparisonTableBody) return;
                
                const filterText = comparisonFilterInput.value.toLowerCase();
                let foundMatch = false;
                
                Array.from(comparisonTableBody.children).forEach(row => {
                    // Assuming 'Заказ' is the first column (index 0)
                    const orderCell = row.children[0];
                    if (orderCell) {
                        const orderText = orderCell.textContent.toLowerCase();
                        if (orderText.includes(filterText)) {
                            row.style.display = '';
                            foundMatch = true;
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
                
                // Show/hide the no data message
                noDataMessageComparison.style.display = foundMatch ? 'none' : 'block';
            };
            
            if (comparisonFilterButton) {
                comparisonFilterButton.addEventListener('click', applyComparisonFilter);
            }
            
            // Optional: Allow filtering on Enter key press in the input field
            if (comparisonFilterInput) {
                comparisonFilterInput.addEventListener('keypress', (event) => {
                    if (event.key === 'Enter') {
                        event.preventDefault(); // Prevent form submission
                        applyComparisonFilter();
                    }
                });
            }
            
            // MIDAS POS Table Filtering Logic
            const midasPosFilterInput = document.getElementById('midas-pos-filter-input');
            const midasPosFilterButton = document.getElementById('midas-pos-filter-button');
            const midasPosTableBody = document.querySelector('#midas-pos-table tbody');
            const noDataMessageMidasPos = document.createElement('p');
            noDataMessageMidasPos.textContent = 'Нет данных по заданному фильтру.';
            noDataMessageMidasPos.style.textAlign = 'center';
            noDataMessageMidasPos.style.padding = '10px';
            noDataMessageMidasPos.style.display = 'none'; // Initially hidden
            
            // Find the container for the MIDAS POS table and append the message
            const midasPosTableContainer = document.querySelector('.midas-pos-table-container');
            if (midasPosTableContainer) {
                midasPosTableContainer.parentNode.insertBefore(noDataMessageMidasPos, midasPosTableContainer.nextSibling);
            }
            
            const applyMidasPosFilter = () => {
                console.log('Applying MIDAS POS filter...');
                if (!midasPosTableBody) return;
                
                const filterText = midasPosFilterInput.value.toLowerCase();
                let foundMatch = false;
                
                Array.from(midasPosTableBody.children).forEach(row => {
                    // Assuming 'Заказ' is the first column (index 0)
                    const orderCell = row.children[0];
                    if (orderCell) {
                        const orderText = orderCell.textContent.toLowerCase();
                        if (orderText.includes(filterText)) {
                            row.style.display = '';
                            foundMatch = true;
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
                
                // Show/hide the no data message
                noDataMessageMidasPos.style.display = foundMatch ? 'none' : 'block';
            };
            
            if (midasPosFilterButton) {
                midasPosFilterButton.addEventListener('click', applyMidasPosFilter);
            }
            
            // Optional: Allow filtering on Enter key press in the input field
            if (midasPosFilterInput) {
                midasPosFilterInput.addEventListener('keypress', (event) => {
                    if (event.key === 'Enter') {
                        event.preventDefault(); // Prevent form submission
                        applyMidasPosFilter();
                    }
                });
            }
            
            // Add event listeners for the JSON copy buttons
            document.querySelectorAll('.json-copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const jsonContainer = this.closest('.json-data-container');
                    const jsonData = jsonContainer.querySelector('.json-data');
                    
                    if (jsonData) {
                        navigator.clipboard.writeText(jsonData.textContent).then(() => {
                            // Visual feedback for successful copy
                            const originalIcon = this.innerHTML;
                            this.innerHTML = '<i class="fas fa-check"></i>';
                            
                            setTimeout(() => {
                                this.innerHTML = originalIcon;
                            }, 2000);
                        }).catch(err => {
                            console.error('Failed to copy text: ', err);
                            alert('Не удалось скопировать JSON.');
                        });
                    }
                });
            });

            // Event listeners for detail arrows (legacy) and module card links (new)
            function setupDetailLinks() {
                // Original detail arrows (from list view)
                detailArrows.forEach(arrow => {
                    arrow.addEventListener('click', function(e) {
                        e.preventDefault();
                        const targetId = this.getAttribute('data-target');
                        console.log('Detail arrow clicked. data-target:', targetId);
                        showContent(targetId);
                        try {
                           if (history.pushState) {
                              history.pushState(null, null, '#' + targetId);
                           } else {
                              window.location.hash = '#' + targetId;
                           }
                        } catch (err) {
                           window.location.hash = '#' + targetId;
                        }
                    });
                });
                
                // New module card links (from card view)
                const moduleCardLinks = document.querySelectorAll('.module-card-link');
                console.log('Module card links found:', moduleCardLinks.length);
                moduleCardLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const targetId = this.getAttribute('data-target');
                        console.log('Module card link clicked. data-target:', targetId);
                        showContent(targetId);
                        try {
                           if (history.pushState) {
                              history.pushState(null, null, '#' + targetId);
                           } else {
                              window.location.hash = '#' + targetId;
                           }
                        } catch (err) {
                           window.location.hash = '#' + targetId;
                        }
                    });
                });
            }
            
            // Call the function to set up all detail links
            setupDetailLinks();
         });
     </script>
</body>
</html>
